---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

const allArticles = await getCollection('articles');
const tags = [...new Set(allArticles.flatMap((article) => article.data.tags))];

const tagCounts = tags.map((tag) => {
  const count = allArticles.filter((article) => 
    article.data.tags.includes(tag)
  ).length;
  return { tag, count };
}).sort((a, b) => b.count - a.count);
---

<BaseLayout 
  title="All Tags" 
  description="Browse articles by tags"
>
  <section class="container py-12">
    <h1 class="text-4xl font-bold mb-8">Tags</h1>
    
    <div class="grid gap-4 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4">
      {tagCounts.map(({ tag, count }) => (
        <a 
          href={`/tags/${tag}`}
          class="card p-4 text-center hover:border-meridian-burgundy transition-colors"
        >
          <h2 class="text-xl font-semibold mb-2">{tag}</h2>
          <p class="text-meridian-steel">
            {count} {count === 1 ? 'article' : 'articles'}
          </p>
        </a>
      ))}
    </div>
  </section>
</BaseLayout>