---
import BaseLayout from '../layouts/BaseLayout.astro';
import ArticleCard from '../components/ArticleCard.astro';
import { getCollection } from 'astro:content';

const allArticles = await getCollection('articles', ({ data }) => {
  return data.draft !== true;
});

const sortedArticles = allArticles.sort(
  (a, b) => b.data.publishDate.valueOf() - a.data.publishDate.valueOf()
);
---

<BaseLayout 
  title="All Articles" 
  description="Browse all articles from Project Meridian Blog"
>
  <section class="container py-12">
    <h1 class="text-4xl font-bold mb-8 dark:text-gray-100">All Articles</h1>
    
    {sortedArticles.length > 0 ? (
      <div class="grid gap-6 md:grid-cols-2 lg:grid-cols-3">
        {sortedArticles.map((article) => (
          <ArticleCard
            title={article.data.title}
            description={article.data.description}
            publishDate={article.data.publishDate}
            author={article.data.author}
            tags={article.data.tags}
            slug={article.slug}
            image={article.data.image}
          />
        ))}
      </div>
    ) : (
      <div class="text-center py-12 bg-meridian-light-gray dark:bg-gray-800 rounded-lg">
        <p class="text-lg text-meridian-steel dark:text-gray-400">
          No articles published yet. Check back soon!
        </p>
      </div>
    )}
  </section>
</BaseLayout>