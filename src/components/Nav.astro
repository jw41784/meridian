---
import Search from './Search';
import ThemeToggle from './ThemeToggle';
import { getUrl } from '../utils/links';

const currentPath = Astro.url.pathname;

const navItems = [
  { label: 'Home', href: getUrl() },
  { label: 'Articles', href: getUrl('articles') },
  { label: 'About', href: getUrl('about') },
];

function isActive(itemHref: string): boolean {
  if (itemHref === getUrl()) {
    return currentPath === getUrl() || currentPath === getUrl().slice(0, -1);
  }
  return currentPath.startsWith(itemHref);
}
---

<header
  class="glass-effect sticky top-0 z-50 border-b border-meridian-light-gray/50 shadow-sm transition-all duration-300 dark:border-gray-700/50"
>
  <nav class="container py-4">
    <div class="flex items-center justify-between gap-4">
      <a
        href={getUrl()}
        class="group flex items-center gap-3 whitespace-nowrap transition-transform duration-300 hover:scale-105"
      >
        <img
          src="/meridian/meridianlogo.svg"
          alt="Project Meridian Logo"
          class="h-8 w-8 transition-transform duration-500 group-hover:rotate-12"
        />
        <span class="gradient-meridian bg-clip-text text-2xl font-bold text-transparent">
          Project Meridian
        </span>
      </a>

      <div class="flex max-w-2xl flex-1 items-center gap-6">
        <ul class="flex items-center space-x-6">
          {
            navItems.map((item) => (
              <li>
                <a
                  href={item.href}
                  class={`relative font-medium transition-all duration-300 ${
                    isActive(item.href)
                      ? 'text-meridian-burgundy dark:text-meridian-steel'
                      : 'text-gray-600 hover:text-meridian-burgundy dark:text-gray-400 dark:hover:text-meridian-steel'
                  }`}
                >
                  {item.label}
                  {isActive(item.href) && (
                    <span class="absolute -bottom-1 left-0 h-0.5 w-full bg-meridian-burgundy dark:bg-meridian-steel" />
                  )}
                </a>
              </li>
            ))
          }
        </ul>

        <div class="max-w-xs flex-1">
          <Search client:load />
        </div>

        <ThemeToggle client:load />
      </div>
    </div>
  </nav>
</header>
